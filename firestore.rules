rules_version = '2';
service cloud.firestore {
  match /databases/gtd-database/documents {
    match /tasks/{taskId} {
      // Helper function to check if user is authorized
      // REPLACE 'your-email@gmail.com' with your actual email address
      function isAuthorized() {
        return request.auth != null && request.auth.token.email == 'brian.fahs@gmail.com';
      }

      // Allow read if user owns the task AND is authorized
      allow read: if isAuthorized() && resource.data.userId == request.auth.uid;
      
      // Allow create if user is authorized and setting their own userId
      allow create: if isAuthorized() && request.resource.data.userId == request.auth.uid;
      
      // Allow update/delete if user owns the task AND is authorized
      allow update, delete: if isAuthorized() && resource.data.userId == request.auth.uid;
    }
  }
}
